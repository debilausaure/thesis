\centering
\begin{tikzpicture}
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (ss)         at (0, 3.3) {\texttt{SS}};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (esp)        at (0, 2.7) {\texttt{ESP}};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (eflags)     at (0, 2.1) {\texttt{EFLAGS}};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (cs)         at (0, 1.5) {\texttt{CS}};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (eip)        at (0, 0.9) {\texttt{EIP}};
	\node[draw, semithick, minimum width=4cm, minimum height=1.8cm, align=center] (greg)       at (0,-0.3) {Registres gÃ©nÃ©raux\\\texttt{(8 dwords)}};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (argn)       at (0,-1.5) {Argument $5$};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (argx)       at (0,-2.1) {$\vdots$};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (arg1)       at (0,-2.7) {Argument $1$};
	\node[draw, semithick, minimum width=4cm, minimum height=0.6cm] (ctx_ptr)    at (0,-3.3) {\texttt{gate\_ctx\_t *}};

	\node[minimum height=0.6cm]                                                  at (0,-4.1) {$\downarrow$};

	\draw[semithick] (-2, -3.6) -- (-2,-4.5);
	\draw[semithick] ( 2, -3.6) -- ( 2,-4.5);

	\node[left=0.5cm of eflags, minimum width=3cm] (iret_ctx_t) {\texttt{iret\_ctx\_t}};
	\draw[dashed, thin] (ss.north west) -- (iret_ctx_t.north |- ss.north west) -- (iret_ctx_t.north);
	\draw[dashed, thin] (eip.south west) -- (iret_ctx_t.south |- eip.south west) -- (iret_ctx_t.south);

	\node[left=0.5cm of greg,   minimum width=3cm] (pushad_regs_t) {\texttt{pushad\_regs\_t}};
	\draw[dashed, thin] (pushad_regs_t.north) -- (pushad_regs_t.north |- eip.south west);
	\draw[dashed, thin] (pushad_regs_t.south) -- (pushad_regs_t.south |- greg.south west) -- (greg.south west);

	\node[right=0.5cm of eip.north east, minimum width=3cm] (gate_ctx_t) {\texttt{gate\_ctx\_t}};
	\draw[dashed, thin] (ss.north east) -- (gate_ctx_t.north |- ss.north east) -- (gate_ctx_t.north);
	\draw[dashed, thin] (greg.south east) -- (gate_ctx_t.south |- greg.south east) -- (gate_ctx_t.south);

	\draw[dashed, thin] (ctx_ptr.east) -- (gate_ctx_t.320 |- ctx_ptr.east);
	\draw[dashed, thin, ->] (gate_ctx_t.320 |- ctx_ptr.east) -- (gate_ctx_t.320);

\end{tikzpicture}
